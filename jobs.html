<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Jobs – Career Unified</title>
<link rel="stylesheet" href="css/style.css">
<link rel="stylesheet" href="css/jobs.css">
</head>
<body>

<header>
  <h1>Available Jobs</h1>
  <p>Find your next opportunity</p>
</header>

<nav>
  <a href="index.html">Home</a>
  <a href="jobs.html" class="active">Jobs</a>
  <a href="bursaries.html">Bursaries</a>
  <a href="varsity.html">Varsity</a>
  <a href="cv-generator.html">Generate CV</a>
</nav>

<main class="jobs-container">
  <div class="jobs-left">
    <div class="search-filter-container">
      <input type="text" id="jobSearch" placeholder="Search job title, company, keyword">
      <select id="categoryFilter">
        <option value="all">All Categories</option>
        <option value="internship">Internship / Graduate</option>
        <option value="temporary">Temporary</option>
        <option value="freelance">Freelance</option>
      </select>
      <button id="sortBtn">Sort by Closing Date</button>
    </div>
    <ul class="jobs-list" id="jobList"></ul>
  </div>
  <div class="jobs-preview" id="jobPreview">
    <p>Select a job to view details</p>
  </div>
</main>

<footer>
  <p>© 2026 Career Unified</p>
</footer>

<script src="js/sanityClient.js"></script>
<script>
const jobList = document.getElementById('jobList');
const jobPreview = document.getElementById('jobPreview');

let jobs = [];
let selectedIndex = null;

async function fetchJobs() {
  jobs = await window.sanityClient.fetch(`*[_type == "job"] | order(deadline asc){
    _id,
    title,
    company,
    description,
    location,
    salary,
    applyLink,
    posted,
    deadline,
    category,
    jobType
  }`);
  renderJobs();
}

function renderJobs() {
  const searchTerm = document.getElementById('jobSearch').value.toLowerCase();
  const category = document.getElementById('categoryFilter').value;

  const filtered = jobs.filter(j => {
    const matchCat = category === 'all' || j.category === category;
    const matchSearch = j.title.toLowerCase().includes(searchTerm) ||
                        j.company.toLowerCase().includes(searchTerm) ||
                        j.description.toLowerCase().includes(searchTerm);
    return matchCat && matchSearch;
  }).sort((a,b) => new Date(a.deadline) - new Date(b.deadline));

  jobList.innerHTML = '';
  if (!filtered.length) {
    jobList.innerHTML = '<li>No jobs found.</li>';
    jobPreview.innerHTML = '<p>Select a job to view details</p>';
    return;
  }

  filtered.forEach((job, index) => {
    const li = document.createElement('li');
    li.className = 'job-card';
    if (index === selectedIndex) li.classList.add('selected');
    li.innerHTML = `
      <h3>${job.title}</h3>
      <p class="company">${job.company}</p>
      <p class="meta">${job.location}</p>
      <p class="salary">${job.salary || 'N/A'}</p>
      <p class="meta">Posted: ${job.posted || 'N/A'} • Closing: ${job.deadline || 'N/A'}</p>
    `;
    li.onclick = () => {
      selectedIndex = index;
      showPreview(job);
      renderJobs();
    };
    jobList.appendChild(li);
  });
}

function showPreview(job) {
  jobPreview.innerHTML = `
    <div class="fade-in">
      <h2>${job.title}</h2>
      <p class="company">${job.company}</p>
      <p><strong>Location:</strong> ${job.location}</p>
      <p><strong>Salary:</strong> ${job.salary || 'N/A'}</p>
      <p><strong>Posted:</strong> ${job.posted || 'N/A'} | <strong>Closing:</strong> ${job.deadline || 'N/A'}</p>
      <div style="white-space:pre-line;margin-top:12px;">${job.description}</div>
      <a class="apply-btn" href="${job.applyLink}" target="_blank">Apply Now</a>
    </div>
  `;
}

document.getElementById('jobSearch').addEventListener('input', renderJobs);
document.getElementById('categoryFilter').addEventListener('change', renderJobs);
document.getElementById('sortBtn').addEventListener('click', renderJobs);

fetchJobs();
</script>
</body>
</html>
















