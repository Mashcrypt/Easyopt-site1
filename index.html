<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Career Unified â€“ Your Career, Your Future</title>

<!-- Google Font -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

<link rel="stylesheet" href="css/style.css">

<style>
.badge-sponsored {
  background: linear-gradient(135deg, #ffb703, #fb8500);
  color: #000;
  font-size: 11px;
  padding: 3px 8px;
  border-radius: 10px;
  margin-left: 6px;
  font-weight: 600;
}
</style>
</head>

<body>

<!-- NAVIGATION -->
<nav class="main-nav">
  <a href="index.html" class="logo">Career Unified</a>
  <div class="nav-links">
    <a href="jobs.html">Jobs</a>
    <a href="bursaries.html">Bursaries</a>
    <a href="varsity.html">Varsity</a>
    <a href="cv-generator.html">Generate CV</a>
    <a href="recruiter-dashboard.html">Recruiter Dashboard</a>
    <a href="signup.html">Sign Up</a>
    <a href="login.html">Login</a>
  </div>
</nav>

<!-- HERO -->
<header class="hero">
  <h1>Career Unified</h1>
  <p class="slogan">One click from your dream</p>

  <form class="hero-search" onsubmit="performSearch(); return false;">
    <input type="text" id="homeSearch" placeholder="Search jobs, companies, bursaries, universities...">
    <button type="submit">Search</button>
  </form>
</header>

<!-- QUICK STATS -->
<section class="quick-stats">
  <div class="stat">
    <h3 id="statJobs">0+</h3>
    <p>Jobs Available</p>
  </div>
  <div class="stat">
    <h3>150+</h3>
    <p>Bursaries</p>
  </div>
  <div class="stat">
    <h3>26</h3>
    <p>Universities</p>
  </div>
  <div class="stat">
    <h3>100%</h3>
    <p>Free Tools</p>
  </div>
</section>

<!-- MAIN -->
<main class="container">
  <h2 class="section-title">Recent Job Openings</h2>
  <div class="job-cards" id="homeJobList"></div>
</main>

<!-- COOKIE NOTICE -->
<div id="cookieNotice" class="cookie-notice">
  <p>
    Career Unified uses browser storage (cookies & localStorage) to improve your experience,
    remember preferences, and analyse site usage.
    By continuing to use this site, you agree to this.
    <a href="privacy.html">Learn more</a>
  </p>
  <button id="acceptCookies">Accept</button>
</div>

<script>
(function () {
  const notice = document.getElementById('cookieNotice');
  const acceptBtn = document.getElementById('acceptCookies');

  if (localStorage.getItem('cookiesAccepted') === 'true') {
    notice.style.display = 'none';
  }

  acceptBtn.addEventListener('click', () => {
    localStorage.setItem('cookiesAccepted', 'true');
    notice.style.display = 'none';
  });
})();
</script>

<!-- FOOTER -->
<footer class="main-footer">
  <div class="footer-links">
    <a href="about-us.html">About Us</a>
    <a href="privacy.html">Privacy Policy</a>
    <a href="terms.html">Terms & Conditions</a>
    <a href="contact-us.html">Contact Us</a>
  </div>
  <p>Â© 2026 Career Unified. All rights reserved.</p>
</footer>

<!-- SCROLL BUTTONS -->
<button id="scrollUp" class="scroll-btn">â†‘</button>
<button id="scrollDown" class="scroll-btn">â†“</button>

<!-- SANITY CLIENT -->
<script src="js/sanityClient.js"></script>

<script>
/* ===============================
   LISTING TIER HELPERS (FIXED)
================================ */

function isPromotionActive(job) {
  if (!job.sponsoredUntil) return true;
  return new Date(job.sponsoredUntil) >= new Date();
}

function getPriority(job) {
  if (job.listingTier === 'premier' && isPromotionActive(job)) return 3;
  if (job.listingTier === 'sponsored' && isPromotionActive(job)) return 2;
  return 1;
}

function getBadge(job) {
  if (job.listingTier === 'premier' && isPromotionActive(job)) return 'Premier';
  if (job.listingTier === 'sponsored' && isPromotionActive(job)) return 'Sponsored';
  return '';
}

/* ===============================
   RECENT JOBS (LOGIC PRESERVED)
================================ */

const homeJobList = document.getElementById('homeJobList');
const statJobs = document.getElementById('statJobs');

async function renderRecentJobs() {
  let jobs = await window.sanityClient.fetch(`*[_type=="job"] | order(posted desc){
    title,
    company,
    location,
    category,
    posted,
    deadline,
    listingTier,
    sponsoredUntil
  }`);

  statJobs.innerText = jobs.length + '+';

  // ðŸ”¥ PRIORITY FIRST, THEN RECENT
  jobs.sort((a, b) => {
    const tierDiff = getPriority(b) - getPriority(a);
    if (tierDiff !== 0) return tierDiff;
    return new Date(b.posted) - new Date(a.posted);
  });

  const today = new Date();
  homeJobList.innerHTML = '';

  jobs.slice(0, 9).forEach(job => {
    const deadlineDate = new Date(job.deadline);
    const isUrgent = (deadlineDate - today) / (1000 * 60 * 60 * 24) <= 7;
    const badge = getBadge(job);

    const card = document.createElement('div');
    card.className = 'job-card';
    card.innerHTML = `
      <h3>
        ${job.title}
        <span class="badge">${job.category}</span>
        ${badge ? `<span class="badge-sponsored">${badge}</span>` : ''}
      </h3>
      <p class="company">${job.company || 'Confidential'}</p>
      <p>${job.location}</p>
      <p class="meta">
        Posted: ${job.posted} â€¢ Closing: ${job.deadline}
        ${isUrgent ? '<span class="urgent">Urgent</span>' : ''}
      </p>
      <a href="jobs.html" class="apply-link">View & Apply</a>
    `;
    homeJobList.appendChild(card);
  });
}

renderRecentJobs();

/* ================= SEARCH ================= */
function performSearch(){
  const term = document.getElementById('homeSearch').value.trim();
  if(!term) return alert('Please enter a keyword');
  localStorage.setItem('homeSearchTerm', term.toLowerCase());
  window.location.href='jobs.html';
}

/* ================= SCROLL ================= */
const up = document.getElementById('scrollUp');
const down = document.getElementById('scrollDown');

window.addEventListener('scroll',()=>{
  up.style.display = down.style.display = window.scrollY > 300 ? 'block' : 'none';
});
up.onclick=()=>window.scrollTo({top:0,behavior:'smooth'});
down.onclick=()=>window.scrollTo({top:document.body.scrollHeight,behavior:'smooth'});
</script>

</body>
</html>














