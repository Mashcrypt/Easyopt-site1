<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Varsity – Career Unified</title>
<link rel="stylesheet" href="css/style.css">
<link rel="stylesheet" href="css/varsity.css">
<style>
/* =============================== */
/* Varsity Page Styles             */
/* =============================== */
.varsity-container {
  display: flex;
  max-width: 1200px;
  margin: 30px auto;
  gap: 20px;
}
.varsity-left {
  flex: 1;
}
.varsity-preview {
  flex: 1;
  background: #fff;
  border-radius: 10px;
  padding: 20px;
  box-shadow: 0 3px 8px rgba(0,0,0,0.1);
  min-height: 420px;
}
.varsity-card {
  background: #fff;
  border-radius: 10px;
  padding: 12px 14px;
  box-shadow: 0 3px 8px rgba(0,0,0,0.1);
  cursor: pointer;
  transition: 0.25s ease;
  margin-bottom: 10px;
}
.varsity-card:hover {
  background-color: #d0e7ff;
  transform: translateY(-2px);
  box-shadow: 0 6px 14px rgba(0,0,0,0.15);
}
.varsity-card.selected {
  border-left: 4px solid #1e3a8a;
}
.varsity-card a { font-size: 15px; text-decoration: none; color:#111827; }
.varsity-card small { display:block; color:#374151; margin-top:2px; }
.status { font-weight:600; margin-left:8px; }
.status.open { color:#16a34a; }
.status.closed { color:#dc2626; }
.urgent { color:#b91c1c; font-weight:600; margin-left:8px; }

/* Search Input */
#searchInput { padding:8px 10px; border-radius:6px; border:1px solid #ccc; width:100%; margin-bottom:10px; }
#sortDeadlineBtn { padding:8px 12px; border-radius:6px; border:none; background:#1e3a8a; color:white; cursor:pointer; font-weight:600; }

/* Fade Animation */
.fade-in { animation: fadeIn 0.35s ease; }
@keyframes fadeIn { from { opacity:0; transform: translateY(8px); } to { opacity:1; transform: translateY(0); } }

/* Apply link */
.varsity-preview a { display:inline-block; margin-top:15px; background:#16a34a; color:white; padding:8px 14px; border-radius:6px; text-decoration:none; font-weight:600; }

/* Scroll Buttons */
.scroll-btn { position: fixed; right: 20px; padding: 10px 14px; border-radius: 50%; border: none; background: #1e3a8a; color: white; cursor: pointer; display: none; z-index: 999; }
#scrollUp { bottom: 80px; }
#scrollDown { bottom: 30px; }

@media (max-width: 900px) { .varsity-container { flex-direction: column; } }
</style>
</head>
<body>

<!-- NAVIGATION -->
<nav class="main-nav">
  <a href="index.html" class="logo">Career Unified</a>
  <div class="nav-links">
    <a href="jobs.html">Jobs</a>
    <a href="bursaries.html">Bursaries</a>
    <a href="varsity.html" class="active">Varsity</a>
    <a href="cv-generator.html">Generate CV</a>
  </div>
</nav>

<!-- HEADER -->
<header>
  <h1>South African Universities</h1>
  <p style="color:white;">Check application deadlines and apply early</p>
</header>

<!-- MAIN -->
<main class="varsity-container">
  <div class="varsity-left">
    <input type="text" id="searchInput" placeholder="Search universities..." />
    <button id="sortDeadlineBtn">Sort by Earliest Deadline</button>
    <ul id="varsityList"></ul>
  </div>
  <div class="varsity-preview" id="varsityPreview">
    <p>Select a university to view details</p>
  </div>
</main>

<!-- FOOTER -->
<footer class="main-footer">
  <div class="footer-links">
    <a href="about-us.html">About Us</a>
    <a href="privacy.html">Privacy Policy</a>
    <a href="terms.html">Terms & Conditions</a>
    <a href="contact-us.html">Contact Us</a>
  </div>
  <p>© 2026 Career Unified. All rights reserved.</p>
</footer>

<!-- SCROLL BUTTONS -->
<button id="scrollUp" class="scroll-btn">↑</button>
<button id="scrollDown" class="scroll-btn">↓</button>

<script src="js/sanityClient.js"></script>
<script>
const varsityList = document.getElementById('varsityList');
const varsityPreview = document.getElementById('varsityPreview');
const searchInput = document.getElementById('searchInput');
const sortBtn = document.getElementById('sortDeadlineBtn');
let universities = [];
let selectedIndex = null;

async function fetchUniversities() {
  universities = await window.sanityClient.fetch(`*[_type=="university"] | order(deadline asc){
    _id,
    name,
    link,
    deadline,
    description
  }`);
  renderList();
}

function renderList() {
  const query = searchInput.value.toLowerCase();
  varsityList.innerHTML = '';

  const filtered = universities.filter(u => u.name.toLowerCase().includes(query));
  if(!filtered.length){
    varsityList.innerHTML = "<li>No universities match your search.</li>";
    varsityPreview.innerHTML = '<p>Select a university to view details</p>';
    return;
  }

  const today = new Date();
  filtered.forEach((uni, index) => {
    const deadlineDate = new Date(uni.deadline);
    const isOpen = deadlineDate >= today;
    const diffDays = Math.ceil((deadlineDate - today)/(1000*60*60*24));
    const isUrgent = diffDays <= 7 && isOpen;

    const li = document.createElement('li');
    li.className = 'varsity-card';
    if(index===selectedIndex) li.classList.add('selected');
    li.innerHTML = `
      <a href="${uni.link}" target="_blank">${uni.name}</a>
      <small>Deadline: ${uni.deadline}</small>
      <span class="status ${isOpen?'open':'closed'}">${isOpen?'Open':'Closed'}</span>
      ${isUrgent ? '<span class="urgent">Urgent!</span>' : ''}
    `;
    li.onclick = () => {
      selectedIndex = index;
      showPreview(uni);
      renderList();
    };
    varsityList.appendChild(li);
  });
}

function showPreview(u){
  varsityPreview.innerHTML = `
    <div class="fade-in">
      <h2>${u.name}</h2>
      <p><strong>Deadline:</strong> ${u.deadline}</p>
      <div style="white-space:pre-line;margin-top:12px;">${u.description || 'No additional info.'}</div>
      <a href="${u.link}" target="_blank">Visit Website</a>
    </div>
  `;
}

searchInput.addEventListener('input', renderList);
sortBtn.addEventListener('click', ()=>{
  universities.sort((a,b)=> new Date(a.deadline)-new Date(b.deadline));
  renderList();
});

fetchUniversities();

// ================= SCROLL =================
const up = document.getElementById('scrollUp');
const down = document.getElementById('scrollDown');
window.addEventListener('scroll',()=>{ up.style.display = down.style.display = window.scrollY > 300 ? 'block' : 'none'; });
up.onclick=()=>window.scrollTo({top:0,behavior:'smooth'});
down.onclick=()=>window.scrollTo({top:document.body.scrollHeight,behavior:'smooth'});
</script>
</body>
</html>







