<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>CV Generator</title>

<link rel="stylesheet" href="css/style.css">
<link rel="stylesheet" href="css/cv-generator.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>

<body>

<header>
  <h1>CV Generator</h1>
</header>

<nav>
  <a href="index.html">Home</a>
  <a href="bursaries.html">Bursaries</a>
  <a href="jobs.html">Jobs</a>
  <a href="cv-generator.html" class="active">Generate CV</a>
</nav>

<main>
  <div class="form-card">
    <input id="fullName" placeholder="Full Name">
    <input id="email" placeholder="Email">
    <input id="phone" placeholder="Phone">

    <textarea id="summary" placeholder="Profile"></textarea>
    <textarea id="education" placeholder="Education"></textarea>
    <textarea id="experience" placeholder="Experience"></textarea>
    <textarea id="skills" placeholder="Skills"></textarea>

    <button onclick="generateCV()">Preview</button>
    <button onclick="downloadPDF()">Download PDF</button>
  </div>

  <div class="preview-card">
    <div id="cvPreview"></div>
  </div>
</main>

<section style="max-width:1000px;margin:40px auto;">
  <h2>CV Tips</h2>
  <div id="cvTipsContainer"></div>
</section>

<script>
const preview = document.getElementById('cvPreview');

function generateCV(){
  preview.innerHTML = `
    <h1>${fullName.value}</h1>
    <p>${email.value} | ${phone.value}</p>

    <h3>Profile</h3>
    <p style="white-space:pre-line;">${summary.value}</p>

    <h3>Education</h3>
    <p style="white-space:pre-line;">${education.value}</p>

    <h3>Experience</h3>
    <p style="white-space:pre-line;">${experience.value}</p>

    <h3>Skills</h3>
    <p style="white-space:pre-line;">${skills.value}</p>
  `;
}

function downloadPDF(){
  html2pdf().from(preview).save("My_CV.pdf");
}

/* LOAD CV TIPS */
const tips = JSON.parse(localStorage.getItem('cvTips')) || [];
const container = document.getElementById('cvTipsContainer');

if(tips.length === 0){
  container.innerHTML = "<p>No CV tips added yet.</p>";
} else {
  tips.forEach(tip=>{
    const div = document.createElement('div');
    div.style.background="#fff";
    div.style.padding="15px";
    div.style.marginBottom="10px";
    div.style.borderRadius="8px";

    div.innerHTML = `
      <strong>${tip.title}</strong>
      <p style="white-space:pre-line;">${tip.content}</p>
    `;
    container.appendChild(div);
  });
}
</script>

<script type="module">
import { sanityClient } from './js/sanityClient.js';

const list = document.getElementById('cvTipsList');

sanityClient.fetch(`*[_type=="cvTip"] | order(category asc)`).then(tips => {
  list.innerHTML = '';
  tips.forEach(tip => {
    list.innerHTML += `
      <div class="card">
        <h3>${tip.title}</h3>
        <small>${tip.category}</small>
        <p>${tip.content}</p>
      </div>
    `;
  });
});
</script>
<div id="cvTipsList"></div>

  
</body>
</html>



